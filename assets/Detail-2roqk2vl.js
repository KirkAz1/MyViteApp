import{_ as b,c as a,a as m,b as o,r as h,t as n,k as B,F,d as C,e as u,o as I,l as L,u as R,f as r}from"./index-BmQPrNaS.js";import{L as H,F as P,H as T,a as f}from"./api-aKvoFoL3.js";const V={name:"DetailView",components:{Header:T,Footer:P,Loading:H},props:{id:{type:String,required:!0}},setup(y){const l=L(),_=R(),t=u({}),p=u([]),c=u(!0),i=u(null),g=(e,d)=>e.length<=d?e:e.substring(0,d)+"...",v=async()=>{c.value=!0;try{const e=await f.getDetailData(l.params.id);t.value=e.data;const d=await f.getRelatedData(t.value.userId);p.value=d.data.filter(D=>D.id!==t.value.id)}catch(e){i.value="无法加载数据，请稍后再试",console.error("获取详情数据失败:",e)}finally{c.value=!1}},s=()=>{_.go(-1)},k=e=>{_.push(`/detail/${e}`)};return I(v),{post:t,relatedPosts:p,loading:c,error:i,truncateText:g,goBack:s,goToDetail:k}}},w={class:"detail"},x={class:"container"},N={key:0,class:"loading-container"},S={key:1,class:"error-message"},q={key:2,class:"post-detail"},E={class:"meta"},M={class:"content"},j={key:0,class:"related-posts"},z={class:"related-grid"},A=["onClick"];function G(y,l,_,t,p,c){const i=h("Header"),g=h("Loading"),v=h("Footer");return r(),a("div",w,[m(i),o("main",null,[o("div",x,[o("button",{onClick:l[0]||(l[0]=(...s)=>t.goBack&&t.goBack(...s)),class:"back-button"},"← 返回"),t.loading?(r(),a("div",N,[m(g)])):t.error?(r(),a("div",S,n(t.error),1)):(r(),a("div",q,[o("h1",null,n(t.post.title),1),o("div",E,[o("span",null,"文章ID: "+n(t.post.id),1),o("span",null,"用户ID: "+n(t.post.userId),1)]),o("div",M,[o("p",null,n(t.post.body),1)]),t.relatedPosts.length>0?(r(),a("div",j,[l[1]||(l[1]=o("h2",null,"相关文章",-1)),o("div",z,[(r(!0),a(F,null,C(t.relatedPosts,s=>(r(),a("div",{key:s.id,class:"related-card",onClick:k=>t.goToDetail(s.id)},[o("h3",null,n(s.title),1),o("p",null,n(t.truncateText(s.body,80)),1)],8,A))),128))])])):B("",!0)]))])]),m(v)])}const O=b(V,[["render",G],["__scopeId","data-v-32243586"]]);export{O as default};
