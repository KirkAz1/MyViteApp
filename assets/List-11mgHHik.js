import{_ as Q,c as b,a as B,b as c,r as E,h as N,v as G,i as X,t as j,F as q,d as z,e as P,j as O,o as J,u as K,f as y}from"./index-BmQPrNaS.js";import{L as Y,F as Z,H as $,a as ee}from"./api-aKvoFoL3.js";var te=typeof global=="object"&&global&&global.Object===Object&&global,ne=typeof self=="object"&&self&&self.Object===Object&&self,V=te||ne||Function("return this")(),L=V.Symbol,A=Object.prototype,re=A.hasOwnProperty,oe=A.toString,k=L?L.toStringTag:void 0;function ie(e){var t=re.call(e,k),l=e[k];try{e[k]=void 0;var n=!0}catch{}var d=oe.call(e);return n&&(t?e[k]=l:delete e[k]),d}var ae=Object.prototype,se=ae.toString;function le(e){return se.call(e)}var ce="[object Null]",de="[object Undefined]",W=L?L.toStringTag:void 0;function ue(e){return e==null?e===void 0?de:ce:W&&W in Object(e)?ie(e):le(e)}function fe(e){return e!=null&&typeof e=="object"}var ge="[object Symbol]";function ve(e){return typeof e=="symbol"||fe(e)&&ue(e)==ge}var me=/\s/;function be(e){for(var t=e.length;t--&&me.test(e.charAt(t)););return t}var ye=/^\s+/;function he(e){return e&&e.slice(0,be(e)+1).replace(ye,"")}function M(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var H=NaN,pe=/^[-+]0x[0-9a-f]+$/i,Te=/^0b[01]+$/i,Pe=/^0o[0-7]+$/i,_e=parseInt;function R(e){if(typeof e=="number")return e;if(ve(e))return H;if(M(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=he(e);var l=Te.test(e);return l||Pe.test(e)?_e(e.slice(2),l?2:8):pe.test(e)?H:+e}var F=function(){return V.Date.now()},Se="Expected a function",je=Math.max,ke=Math.min;function xe(e,t,l){var n,d,f,s,i,u,r=0,_=!1,g=!1,h=!0;if(typeof e!="function")throw new TypeError(Se);t=R(t)||0,M(l)&&(_=!!l.leading,g="maxWait"in l,f=g?je(R(l.maxWait)||0,t):f,h="trailing"in l?!!l.trailing:h);function p(a){var m=n,S=d;return n=d=void 0,r=a,s=e.apply(S,m),s}function C(a){return r=a,i=setTimeout(T,t),_?p(a):s}function I(a){var m=a-u,S=a-r,D=t-m;return g?ke(D,f-S):D}function x(a){var m=a-u,S=a-r;return u===void 0||m>=t||m<0||g&&S>=f}function T(){var a=F();if(x(a))return o(a);i=setTimeout(T,I(a))}function o(a){return i=void 0,h&&n?p(a):(n=d=void 0,s)}function v(){i!==void 0&&clearTimeout(i),r=0,n=u=d=i=void 0}function U(){return i===void 0?s:o(F())}function w(){var a=F(),m=x(a);if(n=arguments,d=this,u=a,m){if(i===void 0)return C(u);if(g)return clearTimeout(i),i=setTimeout(T,t),p(u)}return i===void 0&&(i=setTimeout(T,t)),s}return w.cancel=v,w.flush=U,w}const Oe={name:"ListView",components:{Header:$,Footer:Z,Loading:Y},setup(){const e=K(),t=P([]),l=P(!0),n=P(null),d=P(""),f=P("id"),s=P(1),i=5,u=(o,v)=>o.length<=v?o:o.substring(0,v)+"...",r=async()=>{l.value=!0;try{const o=await ee.getListData(s.value,i);t.value=o.data}catch(o){n.value="无法加载数据，请稍后再试",console.error("获取列表数据失败:",o)}finally{l.value=!1}},_=xe(()=>{s.value=1},300),g=O(()=>t.value.filter(o=>o.title.toLowerCase().includes(d.value.toLowerCase())||o.body.toLowerCase().includes(d.value.toLowerCase()))),h=O(()=>[...g.value].sort((o,v)=>f.value==="title"?o.title.localeCompare(v.title):o.id-v.id)),p=O(()=>Math.ceil(g.value.length/i)),C=O(()=>{const o=(s.value-1)*i,v=o+i;return h.value.slice(o,v)}),I=()=>{s.value<p.value&&s.value++},x=()=>{s.value>1&&s.value--},T=o=>{e.push(`/detail/${o}`)};return J(r),{posts:t,loading:l,error:n,searchQuery:d,sortBy:f,currentPage:s,filteredPosts:g,sortedPosts:h,paginatedPosts:C,totalPages:p,truncateText:u,handleSearch:_,nextPage:I,prevPage:x,goToDetail:T}}},Le={class:"list"},Ce={class:"container"},Ie={class:"search-filter"},we={key:0,class:"loading-container"},Be={key:1,class:"error-message"},Ee={key:2},Fe={key:0,class:"no-results"},Me={key:1,class:"posts-list"},De=["onClick"],Ne={class:"post-id"},We={class:"pagination"},He=["disabled"],Re=["disabled"];function Ve(e,t,l,n,d,f){const s=E("Header"),i=E("Loading"),u=E("Footer");return y(),b("div",Le,[B(s),c("main",null,[c("div",Ce,[t[7]||(t[7]=c("h1",null,"文章列表",-1)),c("div",Ie,[N(c("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>n.searchQuery=r),type:"text",placeholder:"搜索文章...",onInput:t[1]||(t[1]=(...r)=>n.handleSearch&&n.handleSearch(...r))},null,544),[[G,n.searchQuery]]),N(c("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>n.sortBy=r),onChange:t[3]||(t[3]=(...r)=>e.fetchPosts&&e.fetchPosts(...r))},t[6]||(t[6]=[c("option",{value:"id"},"默认排序",-1),c("option",{value:"title"},"按标题排序",-1)]),544),[[X,n.sortBy]])]),n.loading?(y(),b("div",we,[B(i)])):n.error?(y(),b("div",Be,j(n.error),1)):(y(),b("div",Ee,[n.filteredPosts.length===0?(y(),b("div",Fe," 没有找到匹配的文章 ")):(y(),b("div",Me,[(y(!0),b(q,null,z(n.paginatedPosts,r=>(y(),b("div",{key:r.id,class:"post-item",onClick:_=>n.goToDetail(r.id)},[c("h3",null,j(r.title),1),c("p",null,j(n.truncateText(r.body,150)),1),c("span",Ne,"ID: "+j(r.id),1)],8,De))),128))])),c("div",We,[c("button",{disabled:n.currentPage===1,onClick:t[4]||(t[4]=(...r)=>n.prevPage&&n.prevPage(...r))}," 上一页 ",8,He),c("span",null,"第 "+j(n.currentPage)+" 页",1),c("button",{disabled:n.currentPage===n.totalPages,onClick:t[5]||(t[5]=(...r)=>n.nextPage&&n.nextPage(...r))}," 下一页 ",8,Re)])]))])]),B(u)])}const Qe=Q(Oe,[["render",Ve],["__scopeId","data-v-ab4a4c61"]]);export{Qe as default};
